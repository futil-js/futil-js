# For more options, check: https://circleci.com/docs/config-sample/
machine:
  timezone:
    America/New_York
  node:
    version:
      7.5.0

notify:
  webhooks:
    - url: https://coveralls.io/webhook?repo_token=$COVERALLS_REPO_TOKEN

dependencies:
  pre:
    - echo "//registry.npmjs.org/:_authToken=$NPM_TOKEN" >> ~/.npmrc

test:
  override:
    - git remote set-branches --add origin master
    - git fetch
    - npm run lint       > npm-run-lint--output      2>&1 && rm npm-run-lint--output
    - npm run cicoverage > npm-run-cicoverage--ouput 2>&1 && rm npm-run-cicoverage--output 
    - npm test           > npm-test--ouput           2>&1 && rm npm-test--output 
    - ./node_modules/.bin/codacy-coverage < ./coverage/lcov.info
    - rm -fr ./coverage
    - npm run danger

deployment:
  npm:
    branch: master
    commands:
      - npm publish
